import asyncio
import edge_tts
import os

# Default voice controls
DEFAULT_RATE = "-5%"       # speed
DEFAULT_PITCH = "+3Hz"     # tone
DEFAULT_VOLUME = "+0%"

# Output folder name
OUTPUT_DIR = "tamil_output"
OUTPUT_FILE = "scm3.wav"

# Ensure folder exists
os.makedirs(OUTPUT_DIR, exist_ok=True)

voices = {
    # "tamil.wav": (
    #     " A V 7 S C M SILK Supplier Portal роХрпНроХрпБ ро╡ро░ро╡рпЗро▒рпНроХро┐ро▒рпЛроорпН. "
    #     "S C M SILK Supplier Portal роХрпНроХрпБ Appointment роОро╡рпНро╡ро╛ро▒рпБ рокродро┐ро╡рпБ роЪрпЖропрпНро╡родрпБ роОройрпНрокродрпИ рокроЯро┐рокрпНрокроЯро┐ропро╛роХ рокро╛ро░рпНроХрпНроХро▓ро╛роорпН. "
    #     "Google Chrome роР родро┐ро▒роХрпНроХро╡рпБроорпН. "
    #     "Search Box-ро▓рпН www.Thee S C M silk dot com роОройрпНро▒рпБ type роЪрпЖропрпНродрпБ Enter роЕро┤рпБродрпНродро╡рпБроорпН. "
    #     "Home Page open роЖроХрпБроорпН. "
    #     "Login Supplier Portal click роЪрпЖропрпНропро╡рпБроорпН. "
    #     "роЙроЩрпНроХро│рпН User name рооро▒рпНро▒рпБроорпН Password роР enter роЪрпЖропрпНропро╡рпБроорпН, Login click роЪрпЖропрпНропро╡рпБроорпН. "
    #     "роЙро│рпНроирпБро┤рпИроирпНрод рокро┐ро▒роХрпБ, роЕройрпИродрпНродрпБ Option роЗроЯродрпБ рокроХрпНроХродрпНродро┐ро▓рпН роХро╛рогрокрпНрокроЯрпБроорпН. "
    #     "Appointment option click роЪрпЖропрпНропро╡рпБроорпН. "
    #     "Appointment Screen open роЖроХрпБроорпН. "
    #     "Supplier Name родро╛ройро╛роХро╡рпЗ (Auto Display) роХро╛рогрпНрокро┐роХрпНроХрокрпНрокроЯрпБроорпН. "
    #     "Visitor Name рокроХрпБродро┐ропро┐ро▓рпН, роОроЩрпНроХро│рпН роЕро▓рпБро╡ро▓роХродрпНродро┐ро▒рпНроХрпБ ро╡ро░рпБроХрпИ родро░рпБроорпН роирокро░ро┐ройрпН рокрпЖропро░рпИ роХрпБро▒ро┐рокрпНрокро┐роЯро╡рпБроорпН. "
    #     "Designation рокроХрпБродро┐ропро┐ро▓рпН, роЪроирпНродро┐роХрпНроХ ро╡ро┐ро░рпБроорпНрокрпБроорпН роирокро░рпИродрпН родрпЗро░рпНро╡рпБ роЪрпЖропрпНропро╡рпБроорпН. "
    #     "MD Sir, GM Sir, Manager, Employee, роЕро▓рпНро▓родрпБ Others. "
    #     "ро╡ро░рпБроХрпИропро╛ро│ро░ро┐ройрпН Mobile Number enter роЪрпЖропрпНропро╡рпБроорпН. "
    #     "Number of Persons Visit рокроХрпБродро┐ропро┐ро▓рпН роорпКродрпНрод ро╡ро░рпБроХрпИропро╛ро│ро░рпНроХро│ро┐ройрпН роОрогрпНрогро┐роХрпНроХрпИропрпИ роХрпБро▒ро┐рокрпНрокро┐роЯро╡рпБроорпН. "
    #     "Visit Date рокроХрпБродро┐ропро┐ро▓рпН, ро╡ро░рпБроХрпИ родро░рпБроорпН родрпЗродро┐ропрпИродрпН родрпЗро░рпНро╡рпБ роЪрпЖропрпНропро╡рпБроорпН. "
    #     "Visit Time родрпЗро░рпНро╡рпБ роЪрпЖропрпНропро╡рпБроорпН Morning роЕро▓рпНро▓родрпБ Afternoon. "
    #     "Comment Section роЗро▓рпН ро╡ро░рпБроХрпИропро┐ройрпН роирпЛроХрпНроХродрпНродрпИ роХрпБро▒ро┐рокрпНрокро┐роЯро╡рпБроорпН. "
    #     "роЕройрпИродрпНродрпБ ро╡ро┐ро╡ро░роЩрпНроХро│рпИропрпБроорпН роиро┐ро░рокрпНрокро┐роп рокро┐ро▒роХрпБ, Submit роОройрпНро▒ option click роЪрпЖропрпНропро╡рпБроорпН. "
    #     "Success Alert роХро╛рогрпНрокро┐роХрпНроХрокрпНрокроЯрпБроорпН. "
    #     "OK роОройрпНрокродрпИ click роЪрпЖропрпНропро╡рпБроорпН. "
    #     "роОроЩрпНроХро│рпН Management Team роЙроЩрпНроХро│рпИ родрпКроЯро░рпНрокрпБ роХрпКро│рпНро╡ро╛ро░рпНроХро│рпН. "
    #     "роиройрпНро▒ро┐. роиро▓рпНро▓ роиро╛ро│ро╛роХ роЕроорпИроп ро╡ро╛ро┤рпНродрпНродрпБроХрпНроХро│рпН.",
    #     "ta-IN-PallaviNeural",
    #     "-25%",
    #     "+3Hz"
    # ),
    "tamil.wav": (
    "роЪро╛ро░рпН ро╡рогроХрпНроХроорпН, "
    "AV7 SCM Silks Supplier Portal-роХрпНроХрпБ родроЩрпНроХро│рпИ роЕройрпНрокрпБроЯройрпН ро╡ро░ро╡рпЗро▒рпНроХро┐ро▒рпЛроорпН. "
    "роЗроирпНрод ро╡рпАроЯро┐ропрпЛро▓ роиро╛роо роОройрпНрой рокро╛ро░рпНроХрпНроХрокрпН рокрпЛро▒рпЛроорпНройро╛, "
    "Appointment роОрокрпНрокроЯро┐ book рокрогрпНрогрпБро▒родрпБройрпНройрпБ step by step роЖ рокро╛роХрпНроХро▓ро╛роорпН роЪро╛ро░рпН. "
    "роорпБродро▓рпНро▓, Google Chrome-роР open рокрогрпНрогрпБроЩрпНроХ. "
    "Search box-ро▓рпН www.the SCM silk dot com роЕрокрпНрокроЯро┐ройрпНройрпБ type рокрогрпНрогрпБроЩрпНроХ. "
    "Type рокрогрпНрогро┐ройродрпБроорпН Home Page open роЖроХрпБроорпН. "
    "Home Page open роЖрой роЙроЯройрпЗ Login Supplier Portal option роР click рокрогрпНрогрогрпБроорпН роЪро╛ро░рпН. "
    "Click рокрогрпНрогро┐ройро╛ User ID рооро▒рпНро▒рпБроорпН Password роХрпЗроХрпНроХрпБроорпН. "
    "роЕродрпИ enter рокрогрпНрогро┐роЯрпНроЯрпБ Login роХрпКроЯрпБроХрпНроХрогрпБроорпН. "
    "Login рокрогрпНрогро┐ропродрпБроорпН, left side-ро▓рпН роОро▓рпНро▓ро╛ options роЙроорпН роХро╛рогрокрпНрокроЯрпБроорпН роЪро╛ро░рпН. "
    "роЗродрпБро▓ Appointment роЕрокрпНрокроЯро┐роЩрпНроХро┐ро▒ option-роР click рокрогрпНрогро┐ройро╛, "
    "Appointment screen open роЖроХрпБроорпН. "
    "Appointment screen-ро▓рпН Supplier Name already display роЖроХрпБроорпН роЪро╛ро░рпН. "
    "Visitor Name field-ро▓рпН, "
    "ропро╛ро░рпБ office-роХрпНроХрпБ visit рокрогрпНрог ро╡ро░ро╛роЩрпНроХро│рпЛ, роЕро╡ро░рпНроХро│рпЛроЯ name роР type рокрогрпНрогрогрпБроорпН. "
    "Designation field-ро▓рпН, "
    "MD Sir, GM Sir, Manager, Employee роЕро▓рпНро▓родрпБ Others "
    "yaarai  meet рокрогрпНрог ро╡ро░ро╛роЩрпНроХройрпНройрпБ select рокрогрпНрогрогрпБроорпН роЪро╛ро░рпН. "
    "Visitor Mobile Number field-ро▓рпН, "
    "visit рокрогрпНрог ро╡ро░рпНро▒ро╡ро░рпЛроЯ mobile number-роР enter рокрогрпНрогрогрпБроорпН. "
    "Number of Persons field-ро▓рпН, "
    "роОродрпНродройрпИ рокрпЗро░рпН visit рокрогрпНрог ро╡ро░ро╛роЩрпНроХройрпНройрпБ mention рокрогрпНрогрогрпБроорпН. "
    "Visit Date-ро▓рпН, "
    "роОройрпНрой date-ро▓рпН visit рокрогрпНрог ро╡ро░ро╛роЩрпНроХройрпНройрпБ select рокрогрпНрогрогрпБроорпН. "
    "Visit Time-ро▓рпН, "
    "morning-роЖ роЗро▓рпНро▓ afternoon-роЖройрпНройрпБ select рокрогрпНрогрогрпБроорпН. "
    "Comments section-ро▓рпН, "
    "роОроирпНрод purpose-роХрпНроХро╛роХ visit рокрогрпНрог ро╡ро░ро╛роЩрпНроХройрпНройрпБ type рокрогрпНрогрогрпБроорпН роЪро╛ро░рпН. "
    "роЗродрпБ роОро▓рпНро▓ро╛роорпН fill рокрогрпНрогро┐ роорпБроЯро┐роЪрпНроЪродрпБроорпН, "
    "Submit option-ро▓рпН click рокрогрпНрогрпБроЩрпНроХ. "
    "Submit рокрогрпНрогро┐ройродрпБроорпН, "
    "Success роЕрокрпНрокроЯро┐ройрпНройрпБ alert message show роЖроХрпБроорпН. "
    "OK- click рокрогрпНрогро┐ройро╛, "
    "Management team-ро▓рпН роЗро░рпБроирпНродрпБ роЙроЩрпНроХро│рпИ contact рокрогрпНрогрпБро╡ро╛роЩрпНроХ роЪро╛ро░рпН. "
    "Thank you Sir, "
    "Have a good day!",
    "ta-IN-PallaviNeural",
    "-1%",
    "+3Hz"
)

}

async def generate(filename, text, voice, rate, pitch):
    rate = rate or DEFAULT_RATE
    pitch = pitch or DEFAULT_PITCH
    output_path = os.path.join(OUTPUT_DIR, OUTPUT_FILE)

    print(f"ЁЯФК Generating {output_path} | rate={rate}, pitch={pitch}")

    communicate = edge_tts.Communicate(
        text=text,
        voice=voice,
        rate=rate,
        pitch=pitch,
        volume=DEFAULT_VOLUME
    )

    await communicate.save(output_path)

async def main():
    await asyncio.gather(
        *[generate(filename, *data) for filename, data in voices.items()]
    )

    print("\n All audio files saved inside tamil_output folder!")

#  THIS MUST BE AT FILE ROOT LEVEL
if __name__ == "__main__":
    asyncio.run(main())
